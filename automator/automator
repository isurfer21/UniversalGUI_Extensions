#!/usr/bin/env bash
echo " Automator for MiCloud Telepo   version 0.0.5 \n Copyright (c) 2017-18 Abhishek Kumar (kumarab@hcl.com), HCL Tech \n"
argSwitch=$1
argSource=$2
argGarage=$3
if [[ "$argSwitch" == "" ]]; then 
    echo " Command missing! \n"
  else 
    cd $ROOT_DIR
	case "$1" in
    '-copy')
        echo " Copying new repository"
        if [ ! -d "$argGarage" ]; then
            mkdir "$argGarage"
        fi
        cp -R "$argSource/" "$argGarage/"        
        cd "$argGarage"
        rm -r ".git"
        git init "$argGarage"
        echo " Done! \n"
    ;;
    '-sync')
        echo " Syncing the repository"
        if [ ! -d "$argGarage" ]; then
            git init "$argGarage"
        fi
        rsync -av "$argSource/" "$argGarage/" --delete --exclude=".git" --exclude="node_modules"
        echo " Done! \n"
    ;;
    '-rsync')
        echo " Reverse syncing the repository"
        rsync -av "$argGarage/" "$argSource/" --delete --exclude=".git" --exclude="node_modules"
        echo " Done! \n"
    ;;
    '-help')
        echo "\n Options:\n"
        echo "  -help       to see the menu of command line options"
        echo "  -setup      to set up environment"
        echo "  -copy       to copy new repository" 
        echo "  -sync       to sync existing repository"
        echo "  -rsync      to reverse sync existing repository"
        echo "  -merge      to merge existing repository"
        echo "  -diffsync   to merge the source changes into destination directory"
        echo "  -diff       to get changes made in single commit"
        echo "  -diffs      to get changes made in range of commits"
        echo "\n Usage:\n"
        echo "  automator -setup"
        echo "  automator -copy component-template"
        echo "  automator -sync component-template"
        echo "  automator -rsync component-template"
        echo "  automator -merge component-template"
        echo "  automator -merge component-template -preview"
        echo "  automator -diff component-template"
        echo "  automator -diffs component-template"
        echo "  automator -help"
        echo "\n Done! \n"
    ;;
    esac
fi
exit 0